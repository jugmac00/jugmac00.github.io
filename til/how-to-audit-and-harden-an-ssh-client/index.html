<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How to Audit and Harden an SSH Client | Jürgen Gmach</title><meta name=keywords content="ssh,security,audit"><meta name=description content="You probably know how to harden an SSH server, or at least heard of it.
e.g. do not offer weak ciphers, or do not allow root login&mldr;
But did you know you can and also should harden your SSH client?
step 1 - auditing your SSH client terminal 1 git clone https://github.com/jtesta/ssh-audit cd ssh-audit python3.8 ssh-audit.py -c # c = client audit; this starts a ssh server on port 2222 terminal 2 ssh localhost -p 2222 Now, switch back to terminal 1 and have a look at the output - it all should be green - but it won&rsquo;t."><meta name=author content><link rel=canonical href=https://jugmac00.github.io/til/how-to-audit-and-harden-an-ssh-client/><link crossorigin=anonymous href=/assets/css/stylesheet.min.309a3942f890eb0930959205be1f692b2f0e85115a8b0190361a25a37e54fffa.css integrity="sha256-MJo5QviQ6wkwlZIFvh9pKy8OhRFaiwGQNholo35U//o=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://jugmac00.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jugmac00.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jugmac00.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jugmac00.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jugmac00.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><meta property="og:title" content="How to Audit and Harden an SSH Client"><meta property="og:description" content="You probably know how to harden an SSH server, or at least heard of it.
e.g. do not offer weak ciphers, or do not allow root login&mldr;
But did you know you can and also should harden your SSH client?
step 1 - auditing your SSH client terminal 1 git clone https://github.com/jtesta/ssh-audit cd ssh-audit python3.8 ssh-audit.py -c # c = client audit; this starts a ssh server on port 2222 terminal 2 ssh localhost -p 2222 Now, switch back to terminal 1 and have a look at the output - it all should be green - but it won&rsquo;t."><meta property="og:type" content="article"><meta property="og:url" content="https://jugmac00.github.io/til/how-to-audit-and-harden-an-ssh-client/"><meta property="article:section" content="til"><meta property="article:published_time" content="2020-07-22T11:30:28+02:00"><meta property="article:modified_time" content="2020-07-22T11:30:28+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to Audit and Harden an SSH Client"><meta name=twitter:description content="You probably know how to harden an SSH server, or at least heard of it.
e.g. do not offer weak ciphers, or do not allow root login&mldr;
But did you know you can and also should harden your SSH client?
step 1 - auditing your SSH client terminal 1 git clone https://github.com/jtesta/ssh-audit cd ssh-audit python3.8 ssh-audit.py -c # c = client audit; this starts a ssh server on port 2222 terminal 2 ssh localhost -p 2222 Now, switch back to terminal 1 and have a look at the output - it all should be green - but it won&rsquo;t."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Today I Learned","item":"https://jugmac00.github.io/til/"},{"@type":"ListItem","position":3,"name":"How to Audit and Harden an SSH Client","item":"https://jugmac00.github.io/til/how-to-audit-and-harden-an-ssh-client/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to Audit and Harden an SSH Client","name":"How to Audit and Harden an SSH Client","description":"You probably know how to harden an SSH server, or at least heard of it.\ne.g. do not offer weak ciphers, or do not allow root login\u0026hellip;\nBut did you know you can and also should harden your SSH client?\nstep 1 - auditing your SSH client terminal 1 git clone https://github.com/jtesta/ssh-audit cd ssh-audit python3.8 ssh-audit.py -c # c = client audit; this starts a ssh server on port 2222 terminal 2 ssh localhost -p 2222 Now, switch back to terminal 1 and have a look at the output - it all should be green - but it won\u0026rsquo;t.","keywords":["ssh","security","audit"],"articleBody":"You probably know how to harden an SSH server, or at least heard of it.\ne.g. do not offer weak ciphers, or do not allow root login…\nBut did you know you can and also should harden your SSH client?\nstep 1 - auditing your SSH client terminal 1 git clone https://github.com/jtesta/ssh-audit cd ssh-audit python3.8 ssh-audit.py -c # c = client audit; this starts a ssh server on port 2222 terminal 2 ssh localhost -p 2222 Now, switch back to terminal 1 and have a look at the output - it all should be green - but it won’t.\nstep 2 - hardening your SSH client Similar to a server, you have to restrict which Ciphers, KexAlgorithms… you accept.\nBut which Ciphers… are ok?\nLuckily, there is a security expert out there, and he does the hard work, see:\nhttps://www.ssh-audit.com/hardening_guides.html\nBut… echoing the Cipher… configurations did not change anything for me… and this took a while to figure out why.\nTurns out, in your ~/.ssh/config file you have to put all configuration options above your Host configurations, otherwise the options only apply to the last host!\nman 5 ssh_config\n Host Restricts the following declarations (up to the next Host or Match keyword) to be only for those hosts that match one of the patterns given after the keyword.\n TIL: man pages are better than their reputation :-)\nfurther resources https://www.positronsecurity.com/blog/2020-01-07-ssh-client-auditing-and-hardening/\n","wordCount":"230","inLanguage":"en","datePublished":"2020-07-22T11:30:28+02:00","dateModified":"2020-07-22T11:30:28+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jugmac00.github.io/til/how-to-audit-and-harden-an-ssh-client/"},"publisher":{"@type":"Organization","name":"Jürgen Gmach","logo":{"@type":"ImageObject","url":"https://jugmac00.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://jugmac00.github.io accesskey=h title="Jürgen Gmach (Alt + H)">Jürgen Gmach</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jugmac00.github.io/about/ title=about><span>about</span></a></li><li><a href=https://jugmac00.github.io/blog/ title=blog><span>blog</span></a></li><li><a href=https://jugmac00.github.io/til/ title=til><span>today-i-learned</span></a></li><li><a href=https://jugmac00.github.io/talks/ title=talks><span>talks</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>How to Audit and Harden an SSH Client</h1><div class=post-meta>July 22, 2020</div></header><div class=post-content><p>You probably know how to harden an SSH server,
or at least heard of it.</p><p>e.g. do not offer weak ciphers, or do not allow root login&mldr;</p><p>But did you know you can and also should harden your SSH client?</p><h2 id=step-1---auditing-your-ssh-client>step 1 - auditing your SSH client<a hidden class=anchor aria-hidden=true href=#step-1---auditing-your-ssh-client>#</a></h2><h3 id=terminal-1>terminal 1<a hidden class=anchor aria-hidden=true href=#terminal-1>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone https://github.com/jtesta/ssh-audit

cd ssh-audit

python3.8 ssh-audit.py -c  <span style=color:#75715e># c = client audit; this starts a ssh server on port 2222</span>
</code></pre></div><h3 id=terminal-2>terminal 2<a hidden class=anchor aria-hidden=true href=#terminal-2>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>ssh localhost -p <span style=color:#ae81ff>2222</span>
</code></pre></div><p>Now, switch back to terminal 1 and have a look at the output - it all should be green - but it won&rsquo;t.</p><h2 id=step-2---hardening-your-ssh-client>step 2 - hardening your SSH client<a hidden class=anchor aria-hidden=true href=#step-2---hardening-your-ssh-client>#</a></h2><p>Similar to a server,
you have to restrict which <strong>Ciphers</strong>, <strong>KexAlgorithms</strong>&mldr; you accept.</p><p>But which <strong>Ciphers</strong>&mldr; are ok?</p><p>Luckily, there is a security expert out there,
and he does the hard work, see:</p><p><a href=https://www.ssh-audit.com/hardening_guides.html>https://www.ssh-audit.com/hardening_guides.html</a></p><p>But&mldr; echoing the <strong>Cipher</strong>&mldr; configurations did not change anything for me&mldr; and this took a while to figure out why.</p><p>Turns out, in your <code>~/.ssh/config</code> file you have to put all configuration options above your <code>Host</code> configurations,
otherwise the options only apply to the last host!</p><p><code>man 5 ssh_config</code></p><blockquote><p>Host Restricts the following declarations (up to the next Host or Match keyword) to be only for those hosts that match one of the patterns given after the keyword.</p></blockquote><p>TIL: <strong>man pages</strong> are better than their reputation :-)</p><h2 id=further-resources>further resources<a hidden class=anchor aria-hidden=true href=#further-resources>#</a></h2><p><a href=https://www.positronsecurity.com/blog/2020-01-07-ssh-client-auditing-and-hardening/>https://www.positronsecurity.com/blog/2020-01-07-ssh-client-auditing-and-hardening/</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://jugmac00.github.io/tags/ssh/>ssh</a></li><li><a href=https://jugmac00.github.io/tags/security/>security</a></li><li><a href=https://jugmac00.github.io/tags/audit/>audit</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://jugmac00.github.io>Jürgen Gmach</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>