<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>How Many Zope Repositories Are Compatible With Pypy? | Jürgen Gmach</title><meta name=keywords content="zope,all-repos,pypy"><meta name=description content="Today, Johannes Raggam asked on the Plone/Zope community forum whether Zope is able to run on PyPy.
While I am not entirely sure, and I have some vague memories about potential problems with RestrictedPython, I can certainly grep the almost 300 Zope repositories for signs of PyPy support.
The best sign of PyPy support is IMHO that we run tests for it :-)
In order to grep in all repositories I use all-repos by Anthony Sottile."><meta name=author content><link rel=canonical href=https://jugmac00.github.io/til/how-many-zope-repositories-are-compatible-with-pypy/><link crossorigin=anonymous href=/assets/css/stylesheet.min.309a3942f890eb0930959205be1f692b2f0e85115a8b0190361a25a37e54fffa.css integrity="sha256-MJo5QviQ6wkwlZIFvh9pKy8OhRFaiwGQNholo35U//o=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://jugmac00.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jugmac00.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jugmac00.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jugmac00.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jugmac00.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><meta property="og:title" content="How Many Zope Repositories Are Compatible With Pypy?"><meta property="og:description" content="Today, Johannes Raggam asked on the Plone/Zope community forum whether Zope is able to run on PyPy.
While I am not entirely sure, and I have some vague memories about potential problems with RestrictedPython, I can certainly grep the almost 300 Zope repositories for signs of PyPy support.
The best sign of PyPy support is IMHO that we run tests for it :-)
In order to grep in all repositories I use all-repos by Anthony Sottile."><meta property="og:type" content="article"><meta property="og:url" content="https://jugmac00.github.io/til/how-many-zope-repositories-are-compatible-with-pypy/"><meta property="article:section" content="til"><meta property="article:published_time" content="2021-04-19T11:38:06+02:00"><meta property="article:modified_time" content="2021-04-19T11:38:06+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="How Many Zope Repositories Are Compatible With Pypy?"><meta name=twitter:description content="Today, Johannes Raggam asked on the Plone/Zope community forum whether Zope is able to run on PyPy.
While I am not entirely sure, and I have some vague memories about potential problems with RestrictedPython, I can certainly grep the almost 300 Zope repositories for signs of PyPy support.
The best sign of PyPy support is IMHO that we run tests for it :-)
In order to grep in all repositories I use all-repos by Anthony Sottile."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Today I Learned","item":"https://jugmac00.github.io/til/"},{"@type":"ListItem","position":3,"name":"How Many Zope Repositories Are Compatible With Pypy?","item":"https://jugmac00.github.io/til/how-many-zope-repositories-are-compatible-with-pypy/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"How Many Zope Repositories Are Compatible With Pypy?","name":"How Many Zope Repositories Are Compatible With Pypy?","description":"Today, Johannes Raggam asked on the Plone/Zope community forum whether Zope is able to run on PyPy.\nWhile I am not entirely sure, and I have some vague memories about potential problems with RestrictedPython, I can certainly grep the almost 300 Zope repositories for signs of PyPy support.\nThe best sign of PyPy support is IMHO that we run tests for it :-)\nIn order to grep in all repositories I use all-repos by Anthony Sottile.","keywords":["zope","all-repos","pypy"],"articleBody":"Today, Johannes Raggam asked on the Plone/Zope community forum whether Zope is able to run on PyPy.\nWhile I am not entirely sure, and I have some vague memories about potential problems with RestrictedPython, I can certainly grep the almost 300 Zope repositories for signs of PyPy support.\nThe best sign of PyPy support is IMHO that we run tests for it :-)\nIn order to grep in all repositories I use all-repos by Anthony Sottile.\nA naive attempt would something like this…\n❯ all-repos-grep -C all-repos-zope.json \"pypy\" -- 'tox.ini' output_zope/zopefoundation/Acquisition:tox.ini: pypy, output_zope/zopefoundation/Acquisition:tox.ini: pypy3, output_zope/zopefoundation/AuthEncoding:tox.ini: pypy output_zope/zopefoundation/AuthEncoding:tox.ini: pypy3 This should be pretty self-explanatory.\n grep in all Zope repos for pypy but only in tox.ini files  The problem is… there is also pypy3, so I get double hits.\nAs I am only interested in the repositories, and not in the configuration itself, a better way to grep is…\n❯ all-repos-grep -C all-repos-zope.json \"pypy\" --repos-with-matches -- 'tox.ini' output_zope/zopefoundation/Acquisition output_zope/zopefoundation/AuthEncoding output_zope/zopefoundation/BTrees output_zope/zopefoundation/DateTime output_zope/zopefoundation/ExtensionClass output_zope/zopefoundation/Missing output_zope/zopefoundation/MultiMapping output_zope/zopefoundation/Persistence ... When I pipe the result to wc -l I get the number of repositories… 200!\nI am pretty surprised that so many repositories support PyPy!\nIn order to judge this number, let’s see how many active repositories are there in total?\n❯ all-repos-list-repos -C all-repos-zope.json | wc -l 287 ","wordCount":"213","inLanguage":"en","datePublished":"2021-04-19T11:38:06+02:00","dateModified":"2021-04-19T11:38:06+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jugmac00.github.io/til/how-many-zope-repositories-are-compatible-with-pypy/"},"publisher":{"@type":"Organization","name":"Jürgen Gmach","logo":{"@type":"ImageObject","url":"https://jugmac00.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://jugmac00.github.io accesskey=h title="Jürgen Gmach (Alt + H)">Jürgen Gmach</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jugmac00.github.io/about/ title=about><span>about</span></a></li><li><a href=https://jugmac00.github.io/blog/ title=blog><span>blog</span></a></li><li><a href=https://jugmac00.github.io/til/ title=til><span>today-i-learned</span></a></li><li><a href=https://jugmac00.github.io/talks/ title=talks><span>talks</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>How Many Zope Repositories Are Compatible With Pypy?</h1><div class=post-meta><p>zope|all-repos|pypy</p>April 19, 2021</div></header><div class=post-content><p>Today, Johannes Raggam asked on the <a href=https://community.plone.org/t/zope-plone-on-pypy/13726>Plone/Zope community forum</a>
whether <a href=https://github.com/zopefoundation/Zope>Zope</a> is able to run on <a href=https://www.pypy.org/>PyPy</a>.</p><p>While I am not entirely sure,
and I have some vague memories about potential problems with <code>RestrictedPython</code>,
I can certainly grep the almost 300 Zope repositories for signs of <code>PyPy</code> support.</p><p>The best sign of <code>PyPy</code> support is IMHO that we run tests for it :-)</p><p>In order to grep in all repositories I use <a href=https://github.com/asottile/all-repos>all-repos</a> by Anthony Sottile.</p><p>A naive attempt would something like this&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ all-repos-grep -C all-repos-zope.json <span style=color:#e6db74>&#34;pypy&#34;</span> -- <span style=color:#e6db74>&#39;tox.ini&#39;</span>
output_zope/zopefoundation/Acquisition:tox.ini:   pypy,
output_zope/zopefoundation/Acquisition:tox.ini:   pypy3,
output_zope/zopefoundation/AuthEncoding:tox.ini:    pypy
output_zope/zopefoundation/AuthEncoding:tox.ini:    pypy3
</code></pre></div><p>This should be pretty self-explanatory.</p><ul><li>grep</li><li>in all Zope repos</li><li>for pypy</li><li>but only in tox.ini files</li></ul><p>The problem is&mldr; there is also pypy3, so I get double hits.</p><p>As I am only interested in the repositories,
and not in the configuration itself,
a better way to grep is&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ all-repos-grep -C all-repos-zope.json <span style=color:#e6db74>&#34;pypy&#34;</span> --repos-with-matches -- <span style=color:#e6db74>&#39;tox.ini&#39;</span>
output_zope/zopefoundation/Acquisition
output_zope/zopefoundation/AuthEncoding
output_zope/zopefoundation/BTrees
output_zope/zopefoundation/DateTime
output_zope/zopefoundation/ExtensionClass
output_zope/zopefoundation/Missing
output_zope/zopefoundation/MultiMapping
output_zope/zopefoundation/Persistence
...
</code></pre></div><p>When I pipe the result to <code>wc -l</code> I get the number of repositories&mldr; 200!</p><p>I am pretty surprised that so many repositories support <code>PyPy</code>!</p><p>In order to judge this number,
let&rsquo;s see how many active repositories are there in total?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>❯ all-repos-list-repos -C all-repos-zope.json | wc -l
<span style=color:#ae81ff>287</span>
</code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://jugmac00.github.io/tags/zope/>zope</a></li><li><a href=https://jugmac00.github.io/tags/all-repos/>all-repos</a></li><li><a href=https://jugmac00.github.io/tags/pypy/>pypy</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://jugmac00.github.io>Jürgen Gmach</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>