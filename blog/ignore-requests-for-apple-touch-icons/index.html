<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ignore requests for apple touch icons | Jürgen Gmach</title><meta name=keywords content><meta name=description content="the problem My application&rsquo;s error log is polluted with tracebacks of notFoundErrors from Apple browsers requesting apple-touch-icon.pngs.
For those, who do not know&mldr; Touch icons are to Apple&rsquo;s mobile devices what favicons are to (desktop) web browsers.
According to ComputerHope:
 When someone bookmarks your web page or adds your web page to their home screen, this icon is used.
 So, when you run a public website, no question, you want to put some effort into making some great icons, so your website looks great on your users' home screen and bookmark section."><meta name=author content><link rel=canonical href=https://jugmac00.github.io/blog/ignore-requests-for-apple-touch-icons/><link crossorigin=anonymous href=/assets/css/stylesheet.min.309a3942f890eb0930959205be1f692b2f0e85115a8b0190361a25a37e54fffa.css integrity="sha256-MJo5QviQ6wkwlZIFvh9pKy8OhRFaiwGQNholo35U//o=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://jugmac00.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jugmac00.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jugmac00.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jugmac00.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jugmac00.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.82.0"><meta property="og:title" content="ignore requests for apple touch icons"><meta property="og:description" content="the problem My application&rsquo;s error log is polluted with tracebacks of notFoundErrors from Apple browsers requesting apple-touch-icon.pngs.
For those, who do not know&mldr; Touch icons are to Apple&rsquo;s mobile devices what favicons are to (desktop) web browsers.
According to ComputerHope:
 When someone bookmarks your web page or adds your web page to their home screen, this icon is used.
 So, when you run a public website, no question, you want to put some effort into making some great icons, so your website looks great on your users' home screen and bookmark section."><meta property="og:type" content="article"><meta property="og:url" content="https://jugmac00.github.io/blog/ignore-requests-for-apple-touch-icons/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2018-07-28T11:38:38+02:00"><meta property="article:modified_time" content="2018-07-28T11:38:38+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="ignore requests for apple touch icons"><meta name=twitter:description content="the problem My application&rsquo;s error log is polluted with tracebacks of notFoundErrors from Apple browsers requesting apple-touch-icon.pngs.
For those, who do not know&mldr; Touch icons are to Apple&rsquo;s mobile devices what favicons are to (desktop) web browsers.
According to ComputerHope:
 When someone bookmarks your web page or adds your web page to their home screen, this icon is used.
 So, when you run a public website, no question, you want to put some effort into making some great icons, so your website looks great on your users' home screen and bookmark section."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://jugmac00.github.io/blog/"},{"@type":"ListItem","position":3,"name":"ignore requests for apple touch icons","item":"https://jugmac00.github.io/blog/ignore-requests-for-apple-touch-icons/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ignore requests for apple touch icons","name":"ignore requests for apple touch icons","description":"the problem My application\u0026rsquo;s error log is polluted with tracebacks of notFoundErrors from Apple browsers requesting apple-touch-icon.pngs.\nFor those, who do not know\u0026hellip; Touch icons are to Apple\u0026rsquo;s mobile devices what favicons are to (desktop) web browsers.\nAccording to ComputerHope:\n When someone bookmarks your web page or adds your web page to their home screen, this icon is used.\n So, when you run a public website, no question, you want to put some effort into making some great icons, so your website looks great on your users' home screen and bookmark section.","keywords":[],"articleBody":"the problem My application’s error log is polluted with tracebacks of notFoundErrors from Apple browsers requesting apple-touch-icon.pngs.\nFor those, who do not know… Touch icons are to Apple’s mobile devices what favicons are to (desktop) web browsers.\nAccording to ComputerHope:\n When someone bookmarks your web page or adds your web page to their home screen, this icon is used.\n So, when you run a public website, no question, you want to put some effort into making some great icons, so your website looks great on your users' home screen and bookmark section.\nAnd by some effort I mean quite some. I was not able to quickly find out how many icons one has to create currently - for all different screens sizes and resolutions.\nIf you have to take care of touch icons, try Apple’s Configuring Web Applications as a starting point.\ninitial situation I do not run a public website, but an internal application with a two digit user number.\nWhen one of my colleagues accesses the application with an Apple device, and does “things”, nginx, configured as reverse proxy, passes the request for the touch icon to the application server, and it makes boom!\nAt least for the moment, I do not care about the error messages, and I just do not want to see them.\ntechnical solution » design solution The easiest way to get rid of those messages, is NOT to create estimated 18 (update: 40) differently named and sized touch icons, but not to pass the incoming requests to the application server.\nnginx makes this easy, as all I need to add to the configuration, is:\nlocation ~ /apple-touch-icon(|-\\d+x\\d+)(|-precomposed).png { return 404; log_not_found off; } where…\n  the location directive configures what should happen, depending on the request URI\n  ~ means a regex is following\n  apple-touch-icon(|-\\d+x\\d+)(|-precomposed).png should match any and more of the following:\n  apple-touch-icon.png apple-touch-icon-precomposed.png apple-touch-icon-74x74.png apple-touch-icon-180x180.png   return 404 sends “page not found” to the user\n  log_not_found off makes nginx to not log this “error”\n  Fair enough?\nbonus Want to be prepared for the glorious time when you introduce touch icons?\nDig into nginx' try_files directive, so nginx looks for a file and delivers it, and if it’s not there, it returns a 404 (and not pass the request to your application server).\nFollowing (untested) configuration snippet should do the trick:\nlocation ~ /apple-touch-icon(|-\\d+x\\d+)(|-precomposed).png { try_files $uri =404; } further resources  Configuring nginx @Digital Ocean FAQ @Favicon Generator. For real.  ","wordCount":"405","inLanguage":"en","datePublished":"2018-07-28T11:38:38+02:00","dateModified":"2018-07-28T11:38:38+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jugmac00.github.io/blog/ignore-requests-for-apple-touch-icons/"},"publisher":{"@type":"Organization","name":"Jürgen Gmach","logo":{"@type":"ImageObject","url":"https://jugmac00.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://jugmac00.github.io accesskey=h title="Jürgen Gmach (Alt + H)">Jürgen Gmach</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://jugmac00.github.io/about/ title=about><span>about</span></a></li><li><a href=https://jugmac00.github.io/blog/ title=blog><span>blog</span></a></li><li><a href=https://jugmac00.github.io/til/ title=til><span>today-i-learned</span></a></li><li><a href=https://jugmac00.github.io/talks/ title=talks><span>talks</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>ignore requests for apple touch icons</h1><div class=post-meta><p></p>July 28, 2018</div></header><div class=post-content><h2 id=the-problem>the problem<a hidden class=anchor aria-hidden=true href=#the-problem>#</a></h2><p>My application&rsquo;s error log is polluted with tracebacks of <em>notFoundErrors</em> from Apple browsers requesting <em>apple-touch-icon.png</em>s.</p><p>For those, who do not know&mldr;
Touch icons are to Apple&rsquo;s mobile devices what <a href=https://en.wikipedia.org/wiki/Favicon>favicons</a> are to (desktop) web browsers.</p><p>According to <a href=https://www.computerhope.com/jargon/a/appletou.htm>ComputerHope</a>:</p><blockquote><p>When someone bookmarks your web page or adds your web page to their home screen, this icon is used.</p></blockquote><p>So, when you run a public website, no question,
you want to put <em>some effort</em> into making some great icons,
so your website looks great on your users' home screen and bookmark section.</p><p>And by <em>some effort</em> I mean quite some. I was not able to quickly find out how many icons one has to create currently - for all different screens sizes and resolutions.</p><p>If you have to take care of touch icons,
try Apple&rsquo;s <a href=https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/ConfiguringWebApplications/ConfiguringWebApplications.html>Configuring Web Applications</a> as a starting point.</p><h2 id=initial-situation>initial situation<a hidden class=anchor aria-hidden=true href=#initial-situation>#</a></h2><p>I do not run a public website, but an internal application with a two digit user number.</p><p>When one of my colleagues accesses the application with an Apple device, and does &ldquo;things&rdquo;,
nginx, configured as reverse proxy,
passes the request for the touch icon to the application server, and it makes boom!</p><p>At least for the moment,
I do not care about the error messages,
and I just do not want to see them.</p><h2 id=technical-solution--design-solution>technical solution &#187; design solution<a hidden class=anchor aria-hidden=true href=#technical-solution--design-solution>#</a></h2><p>The easiest way to get rid of those messages,
is NOT to create estimated <strong>18</strong> (update: <strong>40</strong>) differently named and sized touch icons,
but not to pass the incoming requests to the application server.</p><p>nginx makes this easy, as all I need to add to the configuration, is:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=color:#66d9ef>location</span> ~ <span style=color:#e6db74>/apple-touch-icon(|-\d+x\d+)(|-precomposed).png</span> {
    <span style=color:#f92672>return</span> <span style=color:#ae81ff>404</span>;
    <span style=color:#f92672>log_not_found</span> <span style=color:#66d9ef>off</span>;
}
</code></pre></div><p>where&mldr;</p><ul><li><p>the <em>location</em> directive configures what should happen, depending on the request <a href=https://en.wikipedia.org/wiki/Uniform_Resource_Identifier>URI</a></p></li><li><p><em>~</em> means a regex is following</p></li><li><p><em>apple-touch-icon(|-\d+x\d+)(|-precomposed).png</em> should match any and more of the following:</p></li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>apple-touch-icon.png
apple-touch-icon-precomposed.png
apple-touch-icon-74x74.png
apple-touch-icon-180x180.png
</code></pre></div><ul><li><p><em>return 404</em> sends &ldquo;page not found&rdquo; to the user</p></li><li><p><em>log_not_found off</em> makes nginx to not log this &ldquo;error&rdquo;</p></li></ul><p>Fair enough?</p><h2 id=bonus>bonus<a hidden class=anchor aria-hidden=true href=#bonus>#</a></h2><p>Want to be prepared for the glorious time when you introduce touch icons?</p><p>Dig into nginx' <a href=http://nginx.org/en/docs/http/ngx_http_core_module.html#try_files>try_files directive</a>,
so nginx looks for a file and delivers it,
and if it&rsquo;s not there, it returns a 404 (and not pass the request to your application server).</p><p>Following (untested) configuration snippet should do the trick:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=color:#66d9ef>location</span> ~ <span style=color:#e6db74>/apple-touch-icon(|-\d+x\d+)(|-precomposed).png</span> {
    <span style=color:#f92672>try_files</span> $uri =<span style=color:#ae81ff>404</span>;
}
</code></pre></div><h2 id=further-resources>further resources<a hidden class=anchor aria-hidden=true href=#further-resources>#</a></h2><ul><li><a href=https://www.digitalocean.com/community/tutorials/understanding-nginx-server-and-location-block-selection-algorithms>Configuring nginx @Digital Ocean</a></li><li><a href=https://realfavicongenerator.net/faq#.W1rgidIzZaQ>FAQ @Favicon Generator. For real.</a></li></ul></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://jugmac00.github.io>Jürgen Gmach</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>