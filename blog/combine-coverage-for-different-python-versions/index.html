<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Combine Coverage for Different Python Versions | Jürgen Gmach</title><meta name=keywords content="coverage,tox"><meta name=description content="Is it enough to run code coverage for a single Python version?
Probably, but not necessarily.
Especially when you still need to support Python 2.7 (sigh), there could be quite some different code paths for Python 2 and Python 3.
A simple example&mldr;
try: import Queue # Python 2 except ImportError: import queue as Queue # Python 3 But also the different Python 3 versions may require that you not only test your code for each interpreter, but also you need to assess code coverage for the different versions, and certainly you want to make sure you got all paths covered."><meta name=author content><link rel=canonical href=https://jugmac00.github.io/blog/combine-coverage-for-different-python-versions/><link crossorigin=anonymous href=/assets/css/stylesheet.96771a12b249af1ff464eabdaa85d1a5268a4379a9f2da62cfd409656ff0233b.css integrity="sha256-lncaErJJrx/0ZOq9qoXRpSaKQ3mp8tpiz9QJZW/wIzs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://jugmac00.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jugmac00.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jugmac00.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jugmac00.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jugmac00.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Combine Coverage for Different Python Versions"><meta property="og:description" content="Is it enough to run code coverage for a single Python version?
Probably, but not necessarily.
Especially when you still need to support Python 2.7 (sigh), there could be quite some different code paths for Python 2 and Python 3.
A simple example&mldr;
try: import Queue # Python 2 except ImportError: import queue as Queue # Python 3 But also the different Python 3 versions may require that you not only test your code for each interpreter, but also you need to assess code coverage for the different versions, and certainly you want to make sure you got all paths covered."><meta property="og:type" content="article"><meta property="og:url" content="https://jugmac00.github.io/blog/combine-coverage-for-different-python-versions/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-11-21T15:34:38+01:00"><meta property="article:modified_time" content="2021-11-21T15:34:38+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Combine Coverage for Different Python Versions"><meta name=twitter:description content="Is it enough to run code coverage for a single Python version?
Probably, but not necessarily.
Especially when you still need to support Python 2.7 (sigh), there could be quite some different code paths for Python 2 and Python 3.
A simple example&mldr;
try: import Queue # Python 2 except ImportError: import queue as Queue # Python 3 But also the different Python 3 versions may require that you not only test your code for each interpreter, but also you need to assess code coverage for the different versions, and certainly you want to make sure you got all paths covered."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://jugmac00.github.io/blog/"},{"@type":"ListItem","position":3,"name":"Combine Coverage for Different Python Versions","item":"https://jugmac00.github.io/blog/combine-coverage-for-different-python-versions/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Combine Coverage for Different Python Versions","name":"Combine Coverage for Different Python Versions","description":"Is it enough to run code coverage for a single Python version?\nProbably, but not necessarily.\nEspecially when you still need to support Python 2.7 (sigh), there could be quite some different code paths for Python 2 and Python 3.\nA simple example\u0026hellip;\ntry: import Queue # Python 2 except ImportError: import queue as Queue # Python 3 But also the different Python 3 versions may require that you not only test your code for each interpreter, but also you need to assess code coverage for the different versions, and certainly you want to make sure you got all paths covered.","keywords":["coverage","tox"],"articleBody":"Is it enough to run code coverage for a single Python version?\nProbably, but not necessarily.\nEspecially when you still need to support Python 2.7 (sigh), there could be quite some different code paths for Python 2 and Python 3.\nA simple example…\ntry: import Queue # Python 2 except ImportError: import queue as Queue # Python 3 But also the different Python 3 versions may require that you not only test your code for each interpreter, but also you need to assess code coverage for the different versions, and certainly you want to make sure you got all paths covered.\nWhen I speak of coverage, I certainly speak of Ned Batchelder’s coverage.py package.\n I wrote previously about how to Enrich Test Coverage With Contexts.\n The Problem Let’s assume you have a simple tox.ini - you use tox for testing, right?\n[tox] envlist =py27 py38 py39 coverage [testenv] deps = pytest commands = pytest [testenv:coverage] basepython =python3 deps =coverage pytest commands =coverage run -m pytest coverage report -m --fail-under=100 Given your code has some branches which are Python 2 specific, coverage would not reach 100% and fail.\nThe same would apply when your code base has some e.g. Python 3.9 specific code paths.\nHow to combine coverage? Obviously, with coverage combine :-)\nYou need to run your tests via coverage, and then combine the results.\n[tox] envlist =py27 py38 py39 coverage [testenv] deps =coverage pytest commands = coverage run -m pytest [testenv:coverage] basepython =python3 deps =coverage commands =coverage combine coverage report -m --fail-under=100 Not so fast - there is one problem:\nCoverage saves the data in .coverage, and so the file gets created by one env run, and overwritten by the next one.\nYou could certainly manipulate the coverage runs to save the coverage files into separate files, but coverage.py, which is the official name of the plugin, already got you covered.\nYou just need to configure coverage/run to use the parallel mode.\nThe Complete tox Configuration [tox] envlist =py27 py38 py39 coverage [testenv] deps =coverage pytest commands = coverage run -m pytest [testenv:coverage] basepython =python3 deps =coverage commands =coverage combine coverage report -m --fail-under=100 [coverage:run] parallel=True Now you can run your tests and get a combined coverage report by…\ntox -e py27,py38,py39,coverage # or just tox Bonus What happens when you run tox and your envlist is sorted in a way that coverage comes first?\nOr you run just tox -e coverage?\nYou will see … ERROR: coverage: commands failed.\nThe Python environments must be run before the coverage env!\ntox has a depends setting for that.\nPlease note - this will indeed run the environments in the correct order, but it will not pull in the dependencies, if you have not specified them!\n= So tox -e coverage will still not work, but tox -e coverage,py27,py38,py39 will.\n Please note: There is an open issue on tox' issue tracker to implement group environments, which would allow to specify to run a group of environments with a single command.\n Final tox Configuration - This Time For Sure [tox] envlist =py27 py38 py39 coverage [testenv] deps =coverage pytest commands = coverage run -m pytest [testenv:coverage] basepython =python3 skip_install =true deps =coverage commands =coverage combine coverage report -m --fail-under=100 depends =py27 py38 py39 [coverage:run] parallel=True Updates 2022-03-19:\n fix commands to run coverage  ","wordCount":"550","inLanguage":"en","datePublished":"2021-11-21T15:34:38+01:00","dateModified":"2021-11-21T15:34:38+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jugmac00.github.io/blog/combine-coverage-for-different-python-versions/"},"publisher":{"@type":"Organization","name":"Jürgen Gmach","logo":{"@type":"ImageObject","url":"https://jugmac00.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://jugmac00.github.io accesskey=h title="Jürgen Gmach (Alt + H)">Jürgen Gmach</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://jugmac00.github.io/about/ title=about><span>about</span></a></li><li><a href=https://jugmac00.github.io/blog/ title=blog><span>blog</span></a></li><li><a href=https://jugmac00.github.io/til/ title=til><span>today-i-learned</span></a></li><li><a href=https://jugmac00.github.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://jugmac00.github.io/hiring/ title=hiring><span>hiring</span></a></li><li><a href=https://jugmac00.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Combine Coverage for Different Python Versions</h1><div class=post-meta><span title="2021-11-21 15:34:38 +0100 +0100">November 21, 2021</span></div></header><div class=post-content><p>Is it enough to run code coverage for a single Python version?</p><p>Probably, but not necessarily.</p><p>Especially when you still need to support Python 2.7 (sigh),
there could be quite some different code paths for Python 2 and Python 3.</p><p>A simple example&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>try</span>:
    <span style=color:#f92672>import</span> Queue  <span style=color:#75715e># Python 2</span>
<span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ImportError</span>:
    <span style=color:#f92672>import</span> queue <span style=color:#f92672>as</span> Queue  <span style=color:#75715e># Python 3</span>
</code></pre></div><p>But also the different Python 3 versions may require that you not only test your code for each interpreter,
but also you need to assess code coverage for the different versions,
and certainly you want to make sure you got all paths covered.</p><p>When I speak of coverage,
I certainly speak of <a href=https://twitter.com/nedbat>Ned Batchelder&rsquo;s</a> <a href=https://coverage.readthedocs.io/en/latest/>coverage.py package</a>.</p><blockquote><p>I wrote previously about how to <a href=https://jugmac00.github.io/blog/enrich-test-coverage-with-contexts/>Enrich Test Coverage With Contexts</a>.</p></blockquote><h2 id=the-problem>The Problem<a hidden class=anchor aria-hidden=true href=#the-problem>#</a></h2><p>Let&rsquo;s assume you have a simple <code>tox.ini</code> - you use <a href=https://tox.wiki/en/latest/>tox</a> for testing, right?</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#66d9ef>[tox]</span>
<span style=color:#a6e22e>envlist</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    py27
</span><span style=color:#e6db74>    py38
</span><span style=color:#e6db74>    py39
</span><span style=color:#e6db74>    coverage</span>

<span style=color:#66d9ef>[testenv]</span>
<span style=color:#a6e22e>deps</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>
</span><span style=color:#e6db74>    pytest</span>
<span style=color:#a6e22e>commands</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>
</span><span style=color:#e6db74>    pytest</span>

<span style=color:#66d9ef>[testenv:coverage]</span>
<span style=color:#a6e22e>basepython</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>     python3</span>
<span style=color:#a6e22e>deps</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage
</span><span style=color:#e6db74>    pytest</span>
<span style=color:#a6e22e>commands</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage run -m pytest
</span><span style=color:#e6db74>    coverage report -m --fail-under=100</span>
</code></pre></div><p>Given your code has some branches which are Python 2 specific,
coverage would not reach 100% and fail.</p><p>The same would apply when your code base has some e.g. Python 3.9 specific code paths.</p><h2 id=how-to-combine-coverage>How to combine coverage?<a hidden class=anchor aria-hidden=true href=#how-to-combine-coverage>#</a></h2><p>Obviously, with <code>coverage combine</code> :-)</p><p>You need to run your tests via coverage, and then combine the results.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#66d9ef>[tox]</span>
<span style=color:#a6e22e>envlist</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    py27
</span><span style=color:#e6db74>    py38
</span><span style=color:#e6db74>    py39
</span><span style=color:#e6db74>    coverage</span>

<span style=color:#66d9ef>[testenv]</span>
<span style=color:#a6e22e>deps</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage
</span><span style=color:#e6db74>    pytest</span>
<span style=color:#a6e22e>commands</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage run -m pytest</span>

<span style=color:#66d9ef>[testenv:coverage]</span>
<span style=color:#a6e22e>basepython</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    python3</span>
<span style=color:#a6e22e>deps</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage</span>
<span style=color:#a6e22e>commands</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage combine
</span><span style=color:#e6db74>    coverage report -m --fail-under=100</span>
</code></pre></div><p>Not so fast - there is one problem:</p><p>Coverage saves the data in <code>.coverage</code>,
and so the file gets created by one env run, and overwritten by the next one.</p><p>You could certainly manipulate the coverage runs to save the coverage files into separate files,
but <code>coverage.py</code>,
which is the official name of the plugin,
already got you covered.</p><p>You just need to configure <code>coverage/run</code> to use the <a href="https://coverage.readthedocs.io/en/latest/cmd.html?highlight=parallel#combining-data-files-coverage-combine">parallel mode</a>.</p><h2 id=the-complete-tox-configuration>The Complete tox Configuration<a hidden class=anchor aria-hidden=true href=#the-complete-tox-configuration>#</a></h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#66d9ef>[tox]</span>
<span style=color:#a6e22e>envlist</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    py27
</span><span style=color:#e6db74>    py38
</span><span style=color:#e6db74>    py39
</span><span style=color:#e6db74>    coverage</span>

<span style=color:#66d9ef>[testenv]</span>
<span style=color:#a6e22e>deps</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage
</span><span style=color:#e6db74>    pytest</span>
<span style=color:#a6e22e>commands</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage run -m pytest</span>

<span style=color:#66d9ef>[testenv:coverage]</span>
<span style=color:#a6e22e>basepython</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    python3</span>
<span style=color:#a6e22e>deps</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage</span>
<span style=color:#a6e22e>commands</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage combine
</span><span style=color:#e6db74>    coverage report -m --fail-under=100</span>

<span style=color:#66d9ef>[coverage:run]</span>
<span style=color:#a6e22e>parallel</span><span style=color:#f92672>=</span><span style=color:#e6db74>True</span>
</code></pre></div><p>Now you can run your tests and get a combined coverage report by&mldr;</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>tox -e py27,py38,py39,coverage
<span style=color:#75715e># or just</span>
tox
</code></pre></div><h2 id=bonus>Bonus<a hidden class=anchor aria-hidden=true href=#bonus>#</a></h2><p>What happens when you run <code>tox</code> and your envlist is sorted in a way that <code>coverage</code> comes first?</p><p>Or you run just <code>tox -e coverage</code>?</p><p>You will see &mldr; <code>ERROR: coverage: commands failed</code>.</p><p>The Python environments must be run before the coverage env!</p><p><code>tox</code> has a <a href=https://tox.wiki/en/latest/config.html#conf-depends>depends</a> setting for that.</p><p>Please note - this will indeed run the environments in the correct order,
but it will not pull in the dependencies,
if you have not specified them!</p><p>=> So <code>tox -e coverage</code> will still not work, but <code>tox -e coverage,py27,py38,py39</code> will.</p><blockquote><p>Please note: There is an <a href=https://github.com/tox-dev/tox/issues/238>open issue</a> on <code>tox</code>' issue tracker to implement <strong>group environments</strong>,
which would allow to specify to run a group of environments with a single command.</p></blockquote><h2 id=final-tox-configuration---this-time-for-sure>Final tox Configuration - This Time For Sure<a hidden class=anchor aria-hidden=true href=#final-tox-configuration---this-time-for-sure>#</a></h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#66d9ef>[tox]</span>
<span style=color:#a6e22e>envlist</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    py27
</span><span style=color:#e6db74>    py38
</span><span style=color:#e6db74>    py39
</span><span style=color:#e6db74>    coverage</span>

<span style=color:#66d9ef>[testenv]</span>
<span style=color:#a6e22e>deps</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage
</span><span style=color:#e6db74>    pytest</span>
<span style=color:#a6e22e>commands</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage run -m pytest</span>

<span style=color:#66d9ef>[testenv:coverage]</span>
<span style=color:#a6e22e>basepython</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    python3</span>
<span style=color:#a6e22e>skip_install</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    true</span>
<span style=color:#a6e22e>deps</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage</span>
<span style=color:#a6e22e>commands</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    coverage combine
</span><span style=color:#e6db74>    coverage report -m --fail-under=100</span>
<span style=color:#a6e22e>depends</span> <span style=color:#f92672>=</span><span style=color:#e6db74>
</span><span style=color:#e6db74>    py27
</span><span style=color:#e6db74>    py38
</span><span style=color:#e6db74>    py39</span>

<span style=color:#66d9ef>[coverage:run]</span>
<span style=color:#a6e22e>parallel</span><span style=color:#f92672>=</span><span style=color:#e6db74>True</span>
</code></pre></div><h2 id=updates>Updates<a hidden class=anchor aria-hidden=true href=#updates>#</a></h2><p><strong>2022-03-19:</strong></p><ul><li>fix commands to run coverage</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://jugmac00.github.io/tags/coverage/>coverage</a></li><li><a href=https://jugmac00.github.io/tags/tox/>tox</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://jugmac00.github.io>Jürgen Gmach</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>