<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>A Special Tool for Special Occasions: The Git Worktree Command | Jürgen Gmach</title><meta name=keywords content="git,worktree"><meta name=description content="What is the issue? Working with branches is fine, as long as you are able to work on one only, or at least have the time to wrap up your work and commit some self-contained and complete state before switching to the next branch.
If you cannot complete your work, it gets messy.
Now, you can either
 use git stash create a work-in-progress(WIP) commit just keep the modified or new files, and try to work around them and to not commit them by accident git clone your repository into another directory  I have done all of them, and they all have their downsides."><meta name=author content><link rel=canonical href=https://jugmac00.github.io/blog/the-git-worktree-command/><link crossorigin=anonymous href=/assets/css/stylesheet.96771a12b249af1ff464eabdaa85d1a5268a4379a9f2da62cfd409656ff0233b.css integrity="sha256-lncaErJJrx/0ZOq9qoXRpSaKQ3mp8tpiz9QJZW/wIzs=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://jugmac00.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jugmac00.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jugmac00.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jugmac00.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jugmac00.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="A Special Tool for Special Occasions: The Git Worktree Command"><meta property="og:description" content="What is the issue? Working with branches is fine, as long as you are able to work on one only, or at least have the time to wrap up your work and commit some self-contained and complete state before switching to the next branch.
If you cannot complete your work, it gets messy.
Now, you can either
 use git stash create a work-in-progress(WIP) commit just keep the modified or new files, and try to work around them and to not commit them by accident git clone your repository into another directory  I have done all of them, and they all have their downsides."><meta property="og:type" content="article"><meta property="og:url" content="https://jugmac00.github.io/blog/the-git-worktree-command/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2023-01-19T07:16:27+01:00"><meta property="article:modified_time" content="2023-01-19T07:16:27+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="A Special Tool for Special Occasions: The Git Worktree Command"><meta name=twitter:description content="What is the issue? Working with branches is fine, as long as you are able to work on one only, or at least have the time to wrap up your work and commit some self-contained and complete state before switching to the next branch.
If you cannot complete your work, it gets messy.
Now, you can either
 use git stash create a work-in-progress(WIP) commit just keep the modified or new files, and try to work around them and to not commit them by accident git clone your repository into another directory  I have done all of them, and they all have their downsides."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Blogs","item":"https://jugmac00.github.io/blog/"},{"@type":"ListItem","position":3,"name":"A Special Tool for Special Occasions: The Git Worktree Command","item":"https://jugmac00.github.io/blog/the-git-worktree-command/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"A Special Tool for Special Occasions: The Git Worktree Command","name":"A Special Tool for Special Occasions: The Git Worktree Command","description":"What is the issue? Working with branches is fine, as long as you are able to work on one only, or at least have the time to wrap up your work and commit some self-contained and complete state before switching to the next branch.\nIf you cannot complete your work, it gets messy.\nNow, you can either\n use git stash create a work-in-progress(WIP) commit just keep the modified or new files, and try to work around them and to not commit them by accident git clone your repository into another directory  I have done all of them, and they all have their downsides.","keywords":["git","worktree"],"articleBody":"What is the issue? Working with branches is fine, as long as you are able to work on one only, or at least have the time to wrap up your work and commit some self-contained and complete state before switching to the next branch.\nIf you cannot complete your work, it gets messy.\nNow, you can either\n use git stash create a work-in-progress(WIP) commit just keep the modified or new files, and try to work around them and to not commit them by accident git clone your repository into another directory  I have done all of them, and they all have their downsides.\nWhat is git worktree? Imagine git branch on steroids.\nWith git worktree you can checkout or create a new branch into a new directory.\nThis means all your changes to one branch are completely isolated from your work on other branches, all your modified files, and especially also the untracked files.\nBut… isn’t this the same as cloning the repository into another directory?\nIt is not! git is fully aware of all existing worktrees.\nAmongst others, this means that remotes are already set, and git offers some handy commands to work with worktrees.\nEnough git worktree (sub-)commands to be dangerous Create a new worktree git worktree add -b  ../ main This command\n creates a new branch with the name  in a directory one level above called  based of the main branch  List all worktrees git worktree list Switch between worktrees As worktrees are directories, you can just use your usual tooling, e.g. cd or pushd and popd.\nDelete a worktree git worktree remove  Every light has its shadow After using git worktree for a couple of days, I have come across a couple of downsides.\nVS Code offers no native support, this means it does not pick up your virtual environment, as that stays in the “main location”.\nAlso some of my plugins do not work correctly, e.g. the Spell Checker plugin, as it does not share the word list between the directories.\nFor one project I need to use a compound test command, which is cumbersome to create when I need to use a longer path to the “main location”.\nI created a bash alias, but ran into another issue as strace does not work with aliases.\nConclusion Even only after using it for a couple of days, git worktree has become an invaluable command in my tool box.\nGiven the downsides, I still try to do most of my work inside the “main location”, but I am really happy to know how to avoid a mess in my checkout when it is necessary.\nThanks Thanks to my colleague Colin Watson who introduced me to the git worktree command.\nFurther information https://git-scm.com/docs/git-worktree\n","wordCount":"460","inLanguage":"en","datePublished":"2023-01-19T07:16:27+01:00","dateModified":"2023-01-19T07:16:27+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://jugmac00.github.io/blog/the-git-worktree-command/"},"publisher":{"@type":"Organization","name":"Jürgen Gmach","logo":{"@type":"ImageObject","url":"https://jugmac00.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><header class=header><nav class=nav><div class=logo><a href=https://jugmac00.github.io accesskey=h title="Jürgen Gmach (Alt + H)">Jürgen Gmach</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://jugmac00.github.io/about/ title=about><span>about</span></a></li><li><a href=https://jugmac00.github.io/blog/ title=blog><span>blog</span></a></li><li><a href=https://jugmac00.github.io/til/ title=til><span>today-i-learned</span></a></li><li><a href=https://jugmac00.github.io/talks/ title=talks><span>talks</span></a></li><li><a href=https://jugmac00.github.io/hiring/ title=hiring><span>hiring</span></a></li><li><a href=https://jugmac00.github.io/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>A Special Tool for Special Occasions: The Git Worktree Command</h1><div class=post-meta><span title="2023-01-19 07:16:27 +0100 +0100">January 19, 2023</span></div></header><div class=post-content><h2 id=what-is-the-issue>What is the issue?<a hidden class=anchor aria-hidden=true href=#what-is-the-issue>#</a></h2><p>Working with branches is fine,
as long as you are able to work on one only,
or at least have the time to wrap up your work
and commit some self-contained
and complete state before switching to the next branch.</p><p>If you cannot complete your work, it gets messy.</p><p>Now, you can either</p><ul><li>use <code>git stash</code></li><li>create a work-in-progress(WIP) commit</li><li>just keep the modified or new files, and try to work around them and to not commit them by accident</li><li><code>git clone</code> your repository into another directory</li></ul><p>I have done all of them, and they all have their downsides.</p><h2 id=what-is-git-worktree>What is <code>git worktree</code>?<a hidden class=anchor aria-hidden=true href=#what-is-git-worktree>#</a></h2><p>Imagine <code>git branch</code> on steroids.</p><p>With <code>git worktree</code> you can checkout or create a new branch
<strong>into a new directory</strong>.</p><p>This means all your changes to one branch are completely isolated from your work on other branches,
all your modified files, and especially also the untracked files.</p><p>But&mldr; isn&rsquo;t this the same as cloning the repository into another directory?</p><p>It is not! <strong>git</strong> is fully aware of all existing <strong>worktrees</strong>.</p><p>Amongst others, this means that remotes are already set,
and <strong>git</strong> offers some handy commands to work with <strong>worktrees</strong>.</p><h2 id=enough-git-worktree-sub-commands-to-be-dangerous>Enough <code>git worktree</code> (sub-)commands to be dangerous<a hidden class=anchor aria-hidden=true href=#enough-git-worktree-sub-commands-to-be-dangerous>#</a></h2><h3 id=create-a-new-worktree>Create a new worktree<a hidden class=anchor aria-hidden=true href=#create-a-new-worktree>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git worktree add -b &lt;branch_name&gt; ../&lt;some_directory&gt; main
</code></pre></div><p>This command</p><ul><li>creates a new branch with the name <code>&lt;branch_name></code></li><li>in a directory one level above called <code>&lt;some_directory></code></li><li>based of the <code>main</code> branch</li></ul><h3 id=list-all-worktrees>List all worktrees<a hidden class=anchor aria-hidden=true href=#list-all-worktrees>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git worktree list
</code></pre></div><h3 id=switch-between-worktrees>Switch between worktrees<a hidden class=anchor aria-hidden=true href=#switch-between-worktrees>#</a></h3><p>As <strong>worktrees</strong> are directories, you can just use your usual tooling,
e.g. <code>cd</code> or <code>pushd</code> and <code>popd</code>.</p><h3 id=delete-a-worktree>Delete a worktree<a hidden class=anchor aria-hidden=true href=#delete-a-worktree>#</a></h3><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git worktree remove &lt;directory_name&gt;
</code></pre></div><h2 id=every-light-has-its-shadow>Every light has its shadow<a hidden class=anchor aria-hidden=true href=#every-light-has-its-shadow>#</a></h2><p>After using <code>git worktree</code> for a couple of days, I have come across a couple of downsides.</p><p>VS Code offers no <a href=https://github.com/microsoft/vscode/issues/68038>native support</a>,
this means it does not pick up your virtual environment, as that stays in the &ldquo;main location&rdquo;.</p><p>Also some of my plugins do not work correctly, e.g. the <strong>Spell Checker</strong> plugin,
as it does not share the word list between the directories.</p><p>For one project I need to use a compound test command,
which is cumbersome to create when I need to use a longer path to the &ldquo;main location&rdquo;.</p><p>I created a bash alias, but ran into another issue as
<a href=https://unix.stackexchange.com/questions/156103>strace</a> does not work with aliases.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Even only after using it for a couple of days,
<code>git worktree</code> has become an invaluable command in my tool box.</p><p>Given the downsides, I still try to do most of my work inside the &ldquo;main location&rdquo;,
but I am really happy to know how to avoid a mess in my checkout when it is necessary.</p><h2 id=thanks>Thanks<a hidden class=anchor aria-hidden=true href=#thanks>#</a></h2><p>Thanks to my colleague <a href=https://www.chiark.greenend.org.uk/~cjwatson/blog/>Colin Watson</a>
who introduced me to the <code>git worktree</code> command.</p><h2 id=further-information>Further information<a hidden class=anchor aria-hidden=true href=#further-information>#</a></h2><p><a href=https://git-scm.com/docs/git-worktree>https://git-scm.com/docs/git-worktree</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://jugmac00.github.io/tags/git/>git</a></li><li><a href=https://jugmac00.github.io/tags/worktree/>worktree</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://jugmac00.github.io>Jürgen Gmach</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>